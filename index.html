<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Khabib Panel v14</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0f172a;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        .box {
            background: #020617;
            padding: 35px;
            border-radius: 10px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.6);
        }
        select, button {
            padding: 12px;
            font-size: 16px;
            margin: 10px;
            border-radius: 5px;
            border: none;
        }
        select { width: 80%; background: #1e293b; color: white; }
        button { background: #22c55e; color: white; cursor: pointer; width: 80%; }
        .flag { font-size: 50px; margin: 20px 0; }
        .big { font-size: 28px; font-weight: bold; margin: 30px 0; }
    </style>
</head>
<body>
<div class="box" id="mainBox">
    <h2>Khabib Panel v14</h2>
    <p>L'admin abuse commence Ã  <strong>17:00 en Belgique</strong>.</p>
    <p>Pour dÃ©bloquer le panel, dis-moi dans quel pays tu es :</p>

    <select id="countrySelect" onchange="showTimezoneIfNeeded()">
        <option value="">Choisis ton pays</option>
        <option value="BE">ğŸ‡§ğŸ‡ª Belgique</option>
        <option value="FR">ğŸ‡«ğŸ‡· France</option>
        <option value="UK">ğŸ‡¬ğŸ‡§ Royaume-Uni</option>
        <option value="DE">ğŸ‡©ğŸ‡ª Allemagne</option>
        <option value="ES">ğŸ‡ªğŸ‡¸ Espagne</option>
        <option value="IT">ğŸ‡®ğŸ‡¹ Italie</option>
        <option value="NL">ğŸ‡³ğŸ‡± Pays-Bas</option>
        <option value="CH">ğŸ‡¨ğŸ‡­ Suisse</option>
        <option value="US">ğŸ‡ºğŸ‡¸ Ã‰tats-Unis</option>
        <option value="CA">ğŸ‡¨ğŸ‡¦ Canada</option>
        <option value="BR">ğŸ‡§ğŸ‡· BrÃ©sil</option>
        <option value="AU">ğŸ‡¦ğŸ‡º Australie</option>
        <option value="RU">ğŸ‡·ğŸ‡º Russie</option>
        <option value="MA">ğŸ‡²ğŸ‡¦ Maroc</option>
        <option value="TN">ğŸ‡¹ğŸ‡³ Tunisie</option>
        <option value="DZ">ğŸ‡©ğŸ‡¿ AlgÃ©rie</option>
        <option value="PT">ğŸ‡µğŸ‡¹ Portugal</option>
        <option value="other">ğŸŒ Autre pays</option>
    </select>

    <div id="timezoneDiv" style="display:none;">
        <p>Choisis ton fuseau horaire :</p>
        <select id="timezoneSelect"></select>
    </div>

    <button onclick="calculateAndUnlock()" id="submitBtn" style="display:none;">Valider</button>
</div>

<script>
const TARGET_HOUR_BELGIUM = 17;
const WEBHOOK_URL = "https://discord.com/api/webhooks/1453050534851379243/QQWpYZbMCPh4wn637YIkWNvpPLw7BxVyo6kJWN2q1xxn4IXiEnL6LGU-wDVhGbMiUaEU";

// Fuseaux horaires par pays (seulement pour ceux qui en ont plusieurs)
const timezones = {
    US: [
        {name: "Est (New York)", tz: "America/New_York"},
        {name: "Centre (Chicago)", tz: "America/Chicago"},
        {name: "Montagne (Denver)", tz: "America/Denver"},
        {name: "Pacifique (Los Angeles)", tz: "America/Los_Angeles"},
        {name: "Alaska", tz: "America/Anchorage"},
        {name: "HawaÃ¯", tz: "Pacific/Honolulu"}
    ],
    CA: [
        {name: "Est (Toronto)", tz: "America/Toronto"},
        {name: "Centre (Winnipeg)", tz: "America/Winnipeg"},
        {name: "Montagne (Edmonton)", tz: "America/Edmonton"},
        {name: "Pacifique (Vancouver)", tz: "America/Vancouver"},
        {name: "Atlantique (Halifax)", tz: "America/Halifax"}
    ],
    AU: [
        {name: "Est (Sydney)", tz: "Australia/Sydney"},
        {name: "Centre (Adelaide)", tz: "Australia/Adelaide"},
        {name: "Ouest (Perth)", tz: "Australia/Perth"}
    ],
    RU: [
        {name: "Moscou", tz: "Europe/Moscow"},
        {name: "Ekaterinbourg", tz: "Asia/Yekaterinburg"},
        {name: "Vladivostok", tz: "Asia/Vladivostok"}
    ],
    BR: [
        {name: "BrasÃ­lia", tz: "America/Sao_Paulo"},
        {name: "Amazonie", tz: "America/Manaus"},
        {name: "Acre", tz: "America/Rio_Branco"}
    ]
};

// Drapeaux et noms pays
const countryNames = {
    BE: "Belgique", FR: "France", UK: "Royaume-Uni", DE: "Allemagne", ES: "Espagne",
    IT: "Italie", NL: "Pays-Bas", CH: "Suisse", US: "Ã‰tats-Unis", CA: "Canada",
    BR: "BrÃ©sil", AU: "Australie", RU: "Russie", MA: "Maroc", TN: "Tunisie",
    DZ: "AlgÃ©rie", PT: "Portugal"
};

function showTimezoneIfNeeded() {
    const country = document.getElementById("countrySelect").value;
    const timezoneDiv = document.getElementById("timezoneDiv");
    const timezoneSelect = document.getElementById("timezoneSelect");
    const submitBtn = document.getElementById("submitBtn");

    timezoneSelect.innerHTML = "";
    timezoneDiv.style.display = "none";
    submitBtn.style.display = "none";

    if (!country || country === "other") {
        submitBtn.style.display = "block";
        return;
    }

    if (timezones[country]) {
        timezoneDiv.style.display = "block";
        timezones[country].forEach(tz => {
            const opt = document.createElement("option");
            opt.value = tz.tz;
            opt.textContent = tz.name;
            timezoneSelect.appendChild(opt);
        });
        submitBtn.style.display = "block";
    } else {
        submitBtn.style.display = "block";
    }
}

function calculateAndUnlock() {
    const countryCode = document.getElementById("countrySelect").value;
    if (!countryCode) return alert("Choisis un pays frÃ¨re");

    let visitorTimezone = "Europe/Brussels"; // default
    let countryName = countryNames[countryCode] || "Autre pays";

    if (timezones[countryCode]) {
        const selectedTz = document.getElementById("timezoneSelect").value;
        if (!selectedTz) return alert("Choisis ton fuseau horaire");
        visitorTimezone = selectedTz;
    } else if (countryCode === "UK") {
        visitorTimezone = "Europe/London";
    } else if (["FR","DE","ES","IT","NL","CH","MA","TN","DZ","PT"].includes(countryCode)) {
        visitorTimezone = "Europe/Paris";
    }

    // Calcul de l'heure
    const today = new Date();
    const belgiumDateStr = today.toLocaleDateString('en-CA', {timeZone: 'Europe/Brussels'}) + ` ${TARGET_HOUR_BELGIUM}:00:00`;
    const belgiumDate = new Date(belgiumDateStr);

    const localTime = belgiumDate.toLocaleTimeString('fr-FR', {
        timeZone: visitorTimezone,
        hour: '2-digit',
        minute: '2-digit'
    });

    // Drapeau
    const flag = countryCode !== "other" 
        ? String.fromCodePoint(...[...countryCode.toUpperCase()].map(c => c.charCodeAt(0) + 127397 - 65))
        : "ğŸŒ";

    // Envoi webhook
    fetch(WEBHOOK_URL, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({content: `Nouveau visiteur \nPays : ${countryName} (${countryCode})`})
    });

    // Affichage final
    document.getElementById("mainBox").innerHTML = `
        <h2>DÃ©bloquÃ© !</h2>
        <div class="flag">${flag}</div>
        <p>L'admin abuse commence Ã  <strong>17:00 en Belgique</strong>.</p>
        <p class="big">Chez toi, Ã§a sera Ã  ${localTime}</p>
        <p class="big" style="color:#22c55e;">Tâ€™as captÃ© ?</p>
        <p style="margin-top: 40px; opacity: 0.8;">Panel ouvert. Bonne chance frÃ¨re.</p>
    `;
}
</script>
</body>
</html>
